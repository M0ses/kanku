domain_name: kanku-gh-pages
default_job: kanku-job
login_user: root
login_pass: kankudai

qemu:
  user: frank

jobs:
 kanku-job:
  -
    use_module: Kanku::Handler::SetJobContext
    options:
      host_interface: eth0
  -
    use_module: Kanku::Handler::OBSCheck
    options:
      project: devel:kanku:images
      repository: images_tumbleweed
      package: openSUSE-Tumbleweed-JeOS:ext4
  -
    use_module: Kanku::Handler::ImageDownload
    options:
      use_cache: 1
  -
    use_module: Kanku::Handler::CreateDomain
    options:
      memory: 2G
      vcpu: 2
      use_9p: 1
      mnt_dir_9p: /srv/www/htdocs
      images_dir: /var/lib/libvirt/images
  -
    use_module: Kanku::Handler::PrepareSSH

  -
    use_module: Kanku::Handler::ExecuteCommandViaSSH
    options:
      commands:
        - zypper -n in apache2
        - systemctl start apache2
        - systemctl enable apache2
